<button
  aria-label="Toggle notifications"
  class="gd-button gd-button-link"
  title="Notifications"
  type="button"
  [gdPopover]="content"
  gdPopoverHorizontalAlignment="right"
  gdPopoverVerticalAlignment="bottom"
>
  <gd-icon icon="bell"></gd-icon>
  <gd-badge *ngIf="notifications?.length">{{ notifications?.length }}</gd-badge>
</button>

<ng-template #content>
  <div class="gd-notifications">
    <gd-repeater *ngIf="notifications?.length">
      <gd-repeater-item *ngFor="let notification of notifications">
        <div [ngSwitch]="notification.type">
          <ng-template ngSwitchCase="gift_comment">
            <a routerLink="/users/{{ notification.gift.comment.user.id }}">{{ notification.gift.comment.user.firstName }} {{ notification.gift.comment.user.lastName }}</a>
            commented on <a routerLink="/gifts/{{ notification.gift.id }}">{{ notification.gift.name }}</a>.<br>
            <span class="gd-text-deemphasized">"{{ notification.gift.comment.summary }}"</span>
          </ng-template>
          <ng-template ngSwitchCase="gift_comment_also">
            <a routerLink="/users/{{ notification.gift.comment.user.id }}">{{ notification.gift.comment.user.firstName }} {{ notification.gift.comment.user.lastName }}</a>
            also commented on <a routerLink="/gifts/{{ notification.gift.id }}">{{ notification.gift.name }}</a>.<br>
            <span class="gd-text-deemphasized">"{{ notification.gift.comment.summary }}"</span>
          </ng-template>
          <ng-template ngSwitchCase="gift_delivered">
            gift delivered<br>
            {{ notification | json }}
          </ng-template>
          <ng-template ngSwitchCase="gift_received">
            gift received<br>
            {{ notification | json }}
          </ng-template>
          <ng-template ngSwitchCase="friendship_new">
            <a routerLink="/users/{{ notification.follower.id }}">{{ notification.follower.firstName }} {{ notification.follower.lastName }}</a>
            has started following you.
          </ng-template>
        </div>

        <time class="gd-text-deemphasized">
          {{ notification.dateCreated | date}}
        </time>

        <gd-repeater-controls>
          <button
            class="gd-button gd-button-default"
            title="Delete notification"
            type="button"
            (click)="removeNotification(notification)"
          >
            <gd-icon icon="trash-alt"></gd-icon>
          </button>
        </gd-repeater-controls>
      </gd-repeater-item>
    </gd-repeater>
  </div>
</ng-template>
